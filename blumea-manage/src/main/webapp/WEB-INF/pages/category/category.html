<!DOCTYPE html>
<!--<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">-->
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <title>mas</title>
    <#include "../common/assets.html"/>
    <script type="text/javascript" src="/backend/ms/assets/js/libs/jquery-1.10.2.min.js"></script>
</head>
<body>
<#include "../common/header.html"/>
<div id="container">
    <#include "../common/sidebar.html"/>
    <div id="content">
        <div class="container">
            <div class="crumbs">
                <ul id="breadcrumbs" class="breadcrumb">
                    <li>
                        <i class="icon-home"></i>
                        <a href="#">文章分类</a>
                    </li>
                    <li class="current">
                    </li>
                </ul>
            </div>
            <div class="row" style="margin-top: 20px;">
                <!--=== Big Buttons ===-->
                <div class="col-md-12">
                    <div class="widget">
                        <div class="widget-header" style="text-align: center;">
                            <a data-toggle="modal" href="#myModal1" class=""><i class="icon-plus-sign icon-large">添加</i></a>
                        </div>

                        <!-- Modal dialog -->
                        <div class="modal fade" id="myModal1">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                        <h4 class="modal-title">创建文章分类</h4>
                                    </div>
                                    <div class="modal-body">
                                        <form class="form-horizontal row-border" id="validate-1" action="#">
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">分类名称<span class="required">*</span></label>

                                                <div class="col-md-9">
                                                    <input type="text" name="categoryName" id="categoryName" class="form-control required" minlength="5" equalTo="[name='pass1']">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-md-3 control-label">分类别名<span class="required">*</span></label>

                                                <div class="col-md-9">
                                                    <input type="text" name="categoryAlias" id="categoryAlias" class="form-control required digits">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
                                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="addCategory();">保 存</button>
                                    </div>
                                </div>
                                <!-- /.modal-content -->
                            </div>
                            <!-- /.modal-dialog -->
                        </div>
                        <!-- /.modal -->

                        <div class="row row-bg" id="category_list"> <!-- .row-bg -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript">
    var rootDiv = '<div class="col-sm-6 col-md-3 hidden-xs">';
    var div01 = '<div class="statbox widget box box-shadow"><div class="widget-content"><div class="visual green"><i class="icon-align-justify"></i>  </div><div class="title">';
    var divTitle = ' <div class="title">';
    var divValue = '<div class="value">';
    var divMore = '<a class="more" data-toggle="dropdown">&nbsp; <i class="pull-right icon-angle-right"></i></a>';
    function addCategory() {
        var categoryName = $("#categoryName").val();
        $.ajax({
            type: "POST",
            url: '/adm/category/add?tm=' + new Date().getTime(),
            data: {categoryName: categoryName},
            dataType: 'json',
            cache: false,
            success: function (response) {
                var categoryName = response.data.categoryName;
                var categoryId = response.data.categoryId;
                var divContent = $("#category_list");
                var uuid = getUUID();
                var newCate = '<div class="col-sm-6 col-md-3 hidden-xs" id="' + uuid + '">'
                        + '<div class="statbox widget box box-shadow">'
                        + '<div class="widget-content">'
                        + '<div class="visual green">'
                        + '<i class="icon-align-justify"></i>'
                        + '</div>'
                        + '<div class="title">' + categoryName + '</div>'
                        + '<div class="value">0</div>'
                        + '<a class="more" data-toggle="dropdown">&nbsp; <i class="pull-right icon-angle-right"></i></a>'

                        + '<ul class="dropdown-menu pull-right" style="text-align: left;">'
                        + '<li><a href="editCategory(' + categoryId + ',' + uuid + '")><i class="icon-edit"></i>编辑</a></li>'
                        + '<li class="divider"></li>'
                        + ' <li><a onclick="deleteCategory(\'' + categoryId + '\',\'' + uuid + '\')"><i class="icon-trash"></i>删除</a></li>'
                        + '</ul>'
                        + '</div>'
                        + '</div>'
                        + '</div>';
                divContent.append(newCate);
                bootbox.alert("添加成功!", function () {

                });
            }
        });

    }

    function editCategory(categoryId, divId) {

    }

    function deleteCategory(categoryId, divId) {
        $.ajax({
                    type: "POST",
                    url: '/adm/category/deleteCategory?tm=' + new Date().getTime(),
                    data: {id: categoryId},
                    dataType: 'json',
                    cache: false,
                    success: function (response) {
                        $("#" + divId).remove();
                        bootbox.alert("删除成功!", function () {

                        });
                    }
                }
        )
    }


    $(document).ready(function () {

        $.ajax({
            type: "POST",
            url: '/adm/category/getAllCategory?tm=' + new Date().getTime(),
            data: {},
            dataType: 'json',
            cache: false,
            success: function (response) {
                var result = "";
                $.each(response.data, function (n, value) {
                    var uuid = getUUID();
                    var newCate = '<div class="col-sm-6 col-md-3 hidden-xs" id="' + uuid + '">'
                            + '<div class="statbox widget box box-shadow">'
                            + '<div class="widget-content">'
                            + '<div class="visual green">'
                            + '<i class="icon-align-justify"></i>'
                            + '</div>'
                            + '<div class="title">' + value.categoryName + '</div>'
                            + '<div class="value">0</div>'
                            + '<a class="more" data-toggle="dropdown">&nbsp; <i class="pull-right icon-angle-right"></i></a>'

                            + '<ul class="dropdown-menu pull-right" style="text-align: left;">'
                            + '<li><a href="editCategory(' + value.categoryId + ',' + uuid + '")><i class="icon-edit"></i>编辑</a></li>'
                            + '<li class="divider"></li>'
                            + ' <li><a href="javascript:void(0)" onclick="deleteCategory(\'' + value.categoryId + '\',\'' + uuid + '\')"><i class="icon-trash"></i>删除</a></li>'
                            + '</ul>'
                            + '</div>'
                            + '</div>'
                            + '</div>';
                    result += newCate;
                });
                $("#category_list").append(result);
            }
        });
    });
</script>
</html>
